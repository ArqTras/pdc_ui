<div class="page-container">
    <div class="toolbar mb-2">
        <div class="left">
            <app-back-button></app-back-button>
            <h1 class="ml-2">{{ 'BREADCRUMBS.ADD_WALLET' | translate }}</h1>
        </div>
        <div class="right"></div>
    </div>

    <div class="page-content">
        <app-breadcrumbs class="mb-2" [items]="breadcrumbItems"></app-breadcrumbs>

        <div class="scrolled-content">
            <form [formGroup]="form" class="form">
                <!-- Name -->
                <div class="form__field">
                    <label for="name">{{ 'RESTORE_WALLET.LABEL_NAME' | translate }}</label>
                    <input
                        (contextmenu)="variablesService.onContextMenu($event)"
                        [placeholder]="'PLACEHOLDERS.WALLET_NAME_PLACEHOLDER' | translate"
                        class="form__field--input"
                        formControlName="name"
                        id="name"
                        type="text"
                    />
                    <div
                        *ngIf="form.get('name').invalid && (form.get('name').dirty || form.get('name').touched)"
                        class="error"
                    >
                        <div *ngIf="form.get('name').hasError('duplicate')">
                            {{ 'RESTORE_WALLET.FORM_ERRORS.NAME_DUPLICATE' | translate }}
                        </div>
                        <div *ngIf="form.get('name').hasError('maxlength')">
                            {{ 'RESTORE_WALLET.FORM_ERRORS.MAX_LENGTH' | translate }}
                        </div>
                        <div *ngIf="form.get('name').hasError('required')">
                            {{ 'RESTORE_WALLET.FORM_ERRORS.NAME_REQUIRED' | translate }}
                        </div>
                    </div>
                </div>

                <!-- Password -->
                <div class="form__field">
                    <label for="password">{{ 'RESTORE_WALLET.PASS' | translate }}</label>
                    <input
                        (contextmenu)="variablesService.onContextMenuPasteSelect($event)"
                        class="form__field--input"
                        formControlName="password"
                        id="password"
                        [placeholder]="'PLACEHOLDERS.WALET_PASSWORD_PLACEHOLDER' | translate"
                        type="password"
                    />
                    <div *ngIf="form.get('password').invalid && (form.get('password').dirty || form.get('password').touched)" class="error">
                        <div *ngIf="form.controls['password'].errors.pattern">
                            {{ 'ERRORS.WRONG_PASSWORD' | translate }}
                        </div>
                    </div>
                </div>

                <!-- Confirm Password -->
                <div class="form__field">
                    <label for="confirm">{{ 'RESTORE_WALLET.CONFIRM' | translate }}</label>
                    <input
                        (contextmenu)="variablesService.onContextMenuPasteSelect($event)"
                        class="form__field--input"
                        formControlName="confirm"
                        id="confirm"
                        [placeholder]="'PLACEHOLDERS.CONFIRM_WALET_PASSWORD_PLACEHOLDER' | translate"
                        type="password"
                    />
                    <div
                        *ngIf="form.hasError('mismatch')"
                        class="error"
                    >
                        {{ 'RESTORE_WALLET.FORM_ERRORS.CONFIRM_NOT_MATCH' | translate }}
                    </div>
                </div>

                <!-- Seed phrase -->
                <div class="form__field">
                    <label for="phrase-key">{{ 'RESTORE_WALLET.LABEL_PHRASE_KEY' | translate }}</label>
                    <input
                        (contextmenu)="variablesService.onContextMenu($event)"
                        [placeholder]="'PLACEHOLDERS.SEED_PHRASE_PLACEHOLDER' | translate"
                        class="form__field--input"
                        formControlName="key"
                        id="phrase-key"
                        type="text"
                    />
                    <div *ngIf="(form.get('key').invalid || !this.seedPhraseInfo?.syntax_correct) && (form.get('key').dirty ||
                    form.get('key').touched)"
                         class="error">
                        <div *ngIf="form.get('key').hasError('required')">
                            {{ 'RESTORE_WALLET.FORM_ERRORS.KEY_REQUIRED' | translate }}
                        </div>
                        <div *ngIf="form.get('key').hasError('password_seed_phrase_not_valid')">
                            {{ 'RESTORE_WALLET.FORM_ERRORS.PASSWORD_SEED_PHRASE_INCORRECT' | translate }}
                        </div>
                        <div *ngIf="!this.seedPhraseInfo?.syntax_correct">
                            {{ 'RESTORE_WALLET.FORM_ERRORS.SEED_PHRASE_IS_NO_VALID' | translate }}
                        </div>
                    </div>
                </div>

                <!-- Seed password -->
                <ng-container *ngIf="seedPhraseInfo">
                    <ng-container *ngIf="seedPhraseInfo.syntax_correct && seedPhraseInfo.require_password">
                        <div class="form__field">
                            <label for="seed-password">{{ 'RESTORE_WALLET.SEED_PASSWORD' | translate }}</label>
                            <input
                                class="form__field--input"
                                formControlName="seedPassword"
                                id="seed-password"
                                [placeholder]="'PLACEHOLDERS.SEED_PHRASE_PLACEHOLDER' | translate"
                                type="password"
                            />
                            <div
                                *ngIf="
                                    (form.get('seedPassword').dirty || form.get('seedPassword').touched) &&
                                    !seedPhraseInfo.hash_sum_matched
                                "
                                class="error"
                            >
                                <span>{{ 'RESTORE_WALLET.FORM_ERRORS.INCORRECT_PASSWORD' | translate }}</span>
                            </div>
                            <div *ngIf="seedPhraseInfo.hash_sum_matched" class="success">
                                <span>{{ 'RESTORE_WALLET.OK' | translate }}</span>
                            </div>
                        </div>
                    </ng-container>
                </ng-container>

                <button
                    (click)="selectLocation()"
                    [disabled]="invalidSeedPhraseInfo"
                    class="outline big w-100 mb-2"
                    type="button"
                >
                    {{ selectedLocationWalletName ?? 'RESTORE_WALLET.BUTTON_SELECT' | translate }}
                </button>

                <button (click)="createWallet()" [disabled]="form.invalid || !selectedLocationWalletPath"
                        class="primary big w-100 mb-2" type="button">
                    {{ 'RESTORE_WALLET.BUTTON_CREATE' | translate }}
                </button>
            </form>
        </div>
    </div>
</div>
